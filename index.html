<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
  <meta name="theme-color" content="#000000" />
  <title>Naclara & Gabies</title>
  <style>
    *{margin:0;padding:0;-webkit-tap-highlight-color:transparent}
    html,body{overflow:hidden;position:fixed;width:100%;height:100%;background:#000;touch-action:none;-webkit-user-select:none;user-select:none}
    canvas{position:fixed;top:0;left:0;width:100%;height:100%;touch-action:none}
  </style>
</head>
<body>
<canvas id="c"></canvas>
<script>
// FOGOS ULTRA LEVE - MOBILE FIRST
// Sem glow, sem radialGradient, poucas partículas, velocidade alta

const C = document.getElementById('c');
const ctx = C.getContext('2d');
let W, H;

function resize() {
  // SEM multiplicar por DPR - muito mais leve
  W = window.innerWidth;
  H = window.innerHeight;
  C.width = W;
  C.height = H;
}
resize();
window.addEventListener('resize', resize);

// Pool simples - arrays tipados
const MAX = 1200;
const ax = new Float32Array(MAX);
const ay = new Float32Array(MAX);
const avx = new Float32Array(MAX);
const avy = new Float32Array(MAX);
const aa = new Float32Array(MAX);  // alpha
const ar = new Uint8Array(MAX);
const ag = new Uint8Array(MAX);
const ab = new Uint8Array(MAX);
const adc = new Float32Array(MAX); // decay
const asz = new Float32Array(MAX); // size
let n = 0;

function add(x,y,vx,vy,r,g,b,alpha,decay,size) {
  if (n >= MAX) return;
  const i = n++;
  ax[i]=x; ay[i]=y; avx[i]=vx; avy[i]=vy;
  ar[i]=r; ag[i]=g; ab[i]=b; aa[i]=alpha;
  adc[i]=decay; asz[i]=size;
}

function del(i) {
  n--;
  if (i < n) {
    ax[i]=ax[n]; ay[i]=ay[n]; avx[i]=avx[n]; avy[i]=avy[n];
    ar[i]=ar[n]; ag[i]=ag[n]; ab[i]=ab[n]; aa[i]=aa[n];
    adc[i]=adc[n]; asz[i]=asz[n];
  }
}

// Cores
function rndCol() {
  const t = Math.random();
  if (t < 0.5) { const v=210+Math.random()*45|0; return [v,v,v]; }
  if (t < 0.75) return [255, 200+Math.random()*40|0, 90+Math.random()*50|0];
  return [200+Math.random()*55|0, 210+Math.random()*45|0, 255];
}

// === EXPLOSÕES - poucas partículas, velocidade ALTA ===

function burst(x, y) {
  const cnt = 20 + (Math.random()*12|0);
  const c = rndCol();
  for (let i = 0; i < cnt; i++) {
    const a = Math.random()*6.28;
    const sp = 3 + Math.random()*6; // RÁPIDO
    add(x, y, Math.cos(a)*sp, Math.sin(a)*sp,
      c[0], c[1], c[2], 1,
      0.012+Math.random()*0.01, 1.5+Math.random()*1.5);
  }
}

function starBurst(x, y) {
  const pts = Math.random()>0.5 ? 5 : 6;
  const cnt = 18 + (Math.random()*10|0);
  const c = rndCol();
  for (let i = 0; i < cnt; i++) {
    const arm = Math.random()*pts|0;
    const ba = (arm/pts)*6.28;
    const a = ba + (Math.random()-0.5)*0.3;
    const sp = 3 + Math.random()*5;
    add(x, y, Math.cos(a)*sp, Math.sin(a)*sp,
      c[0], c[1], c[2], 1,
      0.012+Math.random()*0.008, 1.2+Math.random()*1.2);
  }
}

function shower(x, y) {
  const cnt = 22 + (Math.random()*10|0);
  const c = rndCol();
  for (let i = 0; i < cnt; i++) {
    const a = Math.random()*6.28;
    const sp = 1.5 + Math.random()*4;
    add(x, y, Math.cos(a)*sp, Math.sin(a)*sp*0.5 - 1,
      c[0], c[1], c[2], 1,
      0.006+Math.random()*0.005, 1+Math.random()*1);
  }
}

function sparkle(x, y) {
  const cnt = 15 + (Math.random()*8|0);
  for (let i = 0; i < cnt; i++) {
    const a = Math.random()*6.28;
    const sp = 2 + Math.random()*5;
    add(x, y, Math.cos(a)*sp, Math.sin(a)*sp,
      255, 255, 255, 1,
      0.02+Math.random()*0.015, 0.8+Math.random()*0.8);
  }
}

function ring(x, y) {
  const cnt = 24;
  const c = rndCol();
  const sp = 4 + Math.random()*2;
  for (let i = 0; i < cnt; i++) {
    const a = (i/cnt)*6.28;
    add(x, y, Math.cos(a)*sp, Math.sin(a)*sp,
      c[0], c[1], c[2], 1,
      0.014+Math.random()*0.006, 1.5+Math.random());
  }
}

function doubleBurst(x, y) {
  burst(x, y);
  const c2 = rndCol();
  const cnt = 12;
  for (let i = 0; i < cnt; i++) {
    const a = Math.random()*6.28;
    const sp = 1.5 + Math.random()*2.5;
    add(x, y, Math.cos(a)*sp, Math.sin(a)*sp,
      c2[0], c2[1], c2[2], 1,
      0.008+Math.random()*0.006, 2+Math.random());
  }
}

const TYPES = [burst, starBurst, shower, sparkle, ring, doubleBurst];

function randomBoom(x, y) {
  TYPES[Math.random()*TYPES.length|0](x, y);
}

// === TOUCH - INSTANTÂNEO ===
let lastT = 0;

function pos(e) {
  const t = e.touches ? e.touches[0] : e;
  return { x: t.clientX, y: t.clientY };
}

function boom(e) {
  const p = pos(e);
  randomBoom(p.x, p.y);
}

C.addEventListener('touchstart', function(e) {
  e.preventDefault();
  boom(e);
  lastT = performance.now();
}, { passive: false });

C.addEventListener('touchmove', function(e) {
  e.preventDefault();
  const now = performance.now();
  // Explodir a cada 50ms ao arrastar - super responsivo
  if (now - lastT >= 50) {
    boom(e);
    lastT = now;
  }
}, { passive: false });

// Mouse (PC)
let md = false;
C.addEventListener('mousedown', function(e) { md=true; boom(e); lastT=performance.now(); });
C.addEventListener('mousemove', function(e) {
  if (!md) return;
  const now = performance.now();
  if (now - lastT >= 50) { boom(e); lastT = now; }
});
C.addEventListener('mouseup', function() { md=false; });

// Auto fogos de fundo
let lastAuto = 0;
function autoFire(t) {
  if (t - lastAuto > 1500 + Math.random()*1500) {
    randomBoom(Math.random()*W*0.8+W*0.1, Math.random()*H*0.5+H*0.05);
    lastAuto = t;
  }
}

// Iniciais
setTimeout(()=>randomBoom(W*0.3,H*0.3), 200);
setTimeout(()=>randomBoom(W*0.7,H*0.2), 500);

// === LOOP - ULTRA LEVE ===
function frame(t) {
  // Fade preto - cria trail
  ctx.fillStyle = 'rgba(0,0,0,0.2)';
  ctx.fillRect(0, 0, W, H);

  autoFire(t);

  // Atualizar e desenhar - SEM glow, SEM radialGradient
  for (let i = n - 1; i >= 0; i--) {
    avx[i] *= 0.98;  // friction
    avy[i] *= 0.98;
    avy[i] += 0.08;  // gravidade
    ax[i] += avx[i];
    ay[i] += avy[i];
    aa[i] -= adc[i];

    if (aa[i] <= 0) { del(i); continue; }

    // Cintilação simples
    const flk = Math.random() > 0.03 ? 1 : 0.2;
    const alpha = aa[i] * flk;

    // Desenhar - só fillRect, muito mais rápido que arc
    const sz = asz[i];
    ctx.fillStyle = `rgba(${ar[i]},${ag[i]},${ab[i]},${alpha})`;
    ctx.fillRect(ax[i]-sz*0.5, ay[i]-sz*0.5, sz, sz);
  }

  requestAnimationFrame(frame);
}

requestAnimationFrame(frame);
</script>
</body>
</html>
